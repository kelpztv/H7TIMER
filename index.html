<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>H7 Alliance Boss Timer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg-main:#2b1208;
  --green:#16a34a;
  --red:#991b1b;
}

body{
  margin:0;
  font-family:Arial,sans-serif;
  color:#f1f5f9;
  background:
    linear-gradient(rgba(0,0,0,.65),rgba(0,0,0,.65)),
    url("images/h7.png") center/cover no-repeat,
    var(--bg-main);
}

header{
  background:linear-gradient(to right,#4a0f0f,#7a1d14);
  padding:14px 18px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

header h1{
  font-size:16px;
  margin:0;
}

button{
  background:#2563eb;
  border:none;
  color:#fff;
  padding:5px 10px;
  border-radius:6px;
  cursor:pointer;
  font-size:12px;
}

table{
  width:100%;
  border-collapse:collapse;
  background:rgba(0,0,0,.65);
}

th,td{
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,.08);
  vertical-align:middle;
}

th{
  color:#fde68a;
  font-size:13px;
}

td{
  font-size:13px;
}

.boss-cell{
  display:flex;
  align-items:center;
  gap:10px;
}

.boss-img{
  width:36px;
  height:36px;
  border-radius:6px;
}

.spawned{
  background:var(--green);
  padding:4px 10px;
  border-radius:6px;
  font-weight:bold;
  text-align:center;
}

.countdown{
  background:var(--red);
  padding:4px 10px;
  border-radius:6px;
  font-weight:bold;
  min-width:90px;
  text-align:center;
}
</style>
</head>

<body>

<header>
  <h1>H7 ALLIANCE â€“ BOSS SPAWN TIMER (LOCAL TIME)</h1>
  <button onclick="adminLogin()">Admin</button>
</header>

<table>
<thead>
<tr>
  <th>LV</th>
  <th>BOSS</th>
  <th>DAY</th>
  <th>SPAWN TIME</th>
  <th>STATUS</th>
  <th>ACTION</th>
</tr>
</thead>
<tbody id="bossTable"></tbody>
</table>

<script>
/* ================= CONFIG ================= */
const DISCORD_WEBHOOK =
"https://discord.com/api/webhooks/1463902847891669117/TKAZDfBJPepejw0F1lNRHXSK7dLzUdDh2uy2gq66UKrCpYTJfdc-quyVrFznNbz-g3ta";

const ADMIN_USER="legendweapon";
const ADMIN_PASS="legendweapon";

/* ================= STATE ================= */
let isAdmin = localStorage.getItem("admin")==="1";
let cachedOrder=null;

/* ================= BOSSES ================= */
const bosses=[
 {lv:60,name:"Venatus",img:"venatus.png",interval:10},
 {lv:65,name:"Viorent",img:"viorent.png",interval:10},
 {lv:70,name:"Ego",img:"ego.png",interval:21},
 {lv:75,name:"Clemantis",img:"clemantis.png",fixed:[[1,"13:30"],[4,"21:00"]]},
 {lv:75,name:"Livera",img:"livera.png",interval:24},
 {lv:80,name:"Araneo",img:"araneo.png",interval:24},
 {lv:80,name:"Undomiel",img:"undomiel.png",interval:24},
 {lv:82,name:"Saphirus",img:"saphirus.png",fixed:[[0,"19:00"],[2,"13:30"]]},
 {lv:85,name:"Lady Dalia",img:"ladydalia.png",interval:18},
 {lv:85,name:"General Aquleus",img:"generalaquelus.png",interval:29},
 {lv:86,name:"Thymele",img:"thymele.png",fixed:[[1,"21:00"],[3,"13:30"]]},
 {lv:88,name:"Amentis",img:"amentis.png",interval:29},
 {lv:88,name:"Baron Braudmore",img:"baronbraudmore.png",interval:32},
 {lv:90,name:"Milavy",img:"milavy.png",fixed:[[6,"17:00"]]},
 {lv:92,name:"Wannitas",img:"wannitas.png",interval:48},
 {lv:93,name:"Metus",img:"metus.png",interval:48},
 {lv:94,name:"Duplican",img:"duplican.png",interval:48},
 {lv:95,name:"Shulliar",img:"shulliar.png",interval:35},
 {lv:96,name:"Ringor",img:"ringor.png",fixed:[[6,"19:00"]]},
 {lv:97,name:"Roderick",img:"roderick.png",fixed:[[5,"21:00"]]},
 {lv:98,name:"Gareth",img:"gareth.png",interval:32},
 {lv:98,name:"Titore",img:"titore.png",interval:37},
 {lv:98,name:"Larba",img:"larba.png",interval:35},
 {lv:100,name:"Catena",img:"catena.png",interval:35},
 {lv:100,name:"Auraq",img:"auraq.png",fixed:[[6,"00:00"],[3,"23:00"]]},
 {lv:100,name:"Secreta",img:"secreta.png",interval:62},
 {lv:100,name:"Ordo",img:"ordo.png",interval:62},
 {lv:100,name:"Asta",img:"asta.png",interval:62},
 {lv:100,name:"Supore",img:"supore.png",interval:62},
 {lv:120,name:"Chaiflock",img:"chaiflock.png",fixed:[[6,"00:00"]]}
];
/* ================= DISCORD ================= */
function sendDiscord(msg){
  fetch(DISCORD_WEBHOOK,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({content:msg})
  });
}

/* ================= TIME ================= */
function nextFixed(list){
  const now=new Date();
  let soon=null;
  list.forEach(([d,t])=>{
    const [h,m]=t.split(":");
    let x=new Date(now);
    x.setHours(h,m,0,0);
    x.setDate(x.getDate()+((7+d-x.getDay())%7));
    if(x<=now) x.setDate(x.getDate()+7);
    if(!soon||x<soon) soon=x;
  });
  return soon;
}

function getNext(i){
  let s=localStorage.getItem("next_"+i);
  if(s) return new Date(s);
  let d=bosses[i].interval
    ? new Date(Date.now()+bosses[i].interval*3600000)
    : nextFixed(bosses[i].fixed);
  localStorage.setItem("next_"+i,d.toISOString());
  return d;
}

/* ================= ALERT CHECK ================= */
function checkAlerts(i,name,diff){
  if(diff<=600000 && !localStorage.getItem("a10_"+i)){
    sendDiscord(`â° **${name}** will spawn in **10 minutes**`);
    localStorage.setItem("a10_"+i,"1");
  }
  if(diff<=300000 && !localStorage.getItem("a5_"+i)){
    sendDiscord(`â° **${name}** will spawn in **5 minutes**`);
    localStorage.setItem("a5_"+i,"1");
  }
  if(diff<=0 && !localStorage.getItem("spawn_"+i)){
    sendDiscord(`ðŸš¨ **${name} HAS SPAWNED!**`);
    localStorage.setItem("spawn_"+i,"1");
  }
}

/* ================= RESET ================= */
function resetBoss(i){
  if(!isAdmin) return;
  ["next_","a10_","a5_","spawn_"].forEach(p=>localStorage.removeItem(p+i));
  cachedOrder=null;
}

/* ================= RENDER ================= */
const table=document.getElementById("bossTable");

function render(){
  table.innerHTML="";
  const now=new Date();

  let rows=bosses.map((b,i)=>{
    const next=getNext(i);
    const diff=next-now;
    checkAlerts(i,b.name,diff);
    return{b,i,next,diff,spawned:diff<=0};
  });

  if(!cachedOrder){
    cachedOrder=[
      ...rows.filter(r=>r.spawned),
      ...rows.filter(r=>!r.spawned).sort((a,b)=>a.next-b.next)
    ].map(r=>r.i);
  }

  cachedOrder.map(i=>rows.find(r=>r.i===i)).forEach(r=>{
    const h=Math.max(0,Math.floor(r.diff/3600000));
    const m=Math.max(0,Math.floor((r.diff%3600000)/60000));

    table.innerHTML+=`
<tr>
<td>${r.b.lv}</td>
<td>${r.b.name}</td>
<td>${r.next.toLocaleDateString(undefined,{weekday:"short"})}</td>
<td>${r.next.toLocaleTimeString([], {hour:"2-digit",minute:"2-digit"})}</td>
<td>${r.spawned?'<span class="spawned">SPAWNED</span>':`<span class="countdown">${h}h ${m}m</span>`}</td>
<td>${isAdmin?`<button onclick="resetBoss(${r.i})">Reset</button>`:"-"}</td>
</tr>`;
  });
}

function adminLogin(){
  if(isAdmin){
    localStorage.removeItem("admin");
    isAdmin=false;
    cachedOrder=null;
    return;
  }
  if(prompt("Username")===ADMIN_USER && prompt("Password")===ADMIN_PASS){
    localStorage.setItem("admin","1");
    isAdmin=true;
  }
}

setInterval(render,1000);
render();
</script>

</body>
</html>
